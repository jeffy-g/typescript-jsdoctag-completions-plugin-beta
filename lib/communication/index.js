(()=>{var e={222:(e,o,t)=>{const n=t(808),r=t(185),s=`${r.Options.host}:${r.Options.port}`,i=()=>{const e=new Date;return`[${e.toLocaleTimeString()}.${(e.getMilliseconds()+"").padStart(3,"0")} jsdoctag-completions-plugin:client]`},c={log:()=>{}};e.exports=(e,o=c)=>{let t,l,a=!1,g=0,u=1500;const d=()=>{if(a||++g>=20)return o.log(`${i()} ${a?"RECONNECT SUCCEED!":"RECONNECTION FAILED"}`),void clearTimeout(l);o.log(`${i()} Trying to reconnect`),p(),l=setTimeout(d,u<<=1)},p=()=>{t?t.connect(r.Options):t=n.connect(r.Options).on("connect",(function(){a=!0,console.log(`${i()} Connection - ${s}`)})).on("data",(function(t){let n=t.toString();try{const t=JSON.parse(n);o.log(`${i()} event from ${t.projectName}`),e(t)}catch(e){console.log(e.toString())}})).on("timeout",(()=>{
o.log(`${i()} socket timeout`)})).on("error",(function(e){o.log(`${i()} Connection Failed - ${s}`),console.error(e.message),"ECONNREFUSED"!==e.code||l||(l=setTimeout(d,u<<=1))})).on("end",(function(){o.log(`${i()} Connection End - ${s}`)})).on("close",(function(e){o.log(`${i()} Connection Closed, hadError=${e}`)}))};setTimeout(p,u)}},185:(e,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Options=void 0,o.Options={host:"127.0.0.1",port:55555}},498:(e,o,t)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.fireProjectUpdateEvent=o.launchMessageServer=void 0;const n=t(808),r=t(185),s=t(915),i="jsdoctag-completions-plugin:server",c={...r.Options,ipv6Only:!0},l=[];let a,g=!1;o.launchMessageServer=()=>{if(g)return void s.log(`${i} WARNNING: plugin message server already launched!`)
;g=!0;const e=e=>`${e}/${a.maxConnections||"unlimited"}`,t=e=>{s.log(`${i} ERROR: ${e.message}`)};a=n.createServer().on("connection",(function(n){l.push(n),s.log(`${i} event listener comes`),a.getConnections(((o,r)=>{if(o)t(o);else{const o=`${n.remoteAddress}:${n.remotePort}`;s.log(`${i} Connection Start(${e(r)}) - ${o}`),n.on("end",(function(){!function(e){const o=l.indexOf(e);-1!==o&&l.splice(o,1)}(n),a.getConnections(((n,r)=>{n?t(n):s.log(`${i} Connection End(${e(r)}) - ${o}`)}))}))}})),u.length&&(0,o.fireProjectUpdateEvent)(u.pop())})).on("error",(function(e){s.log(`${i} [${JSON.stringify(e)}]`)})).on("close",(function(){s.log(`${i} Server Closed`)})).on("listening",(function(){const e=a.address();s.log(`${i} Listening Start on Server - ${e.address}:${e.port}`)})).listen(c)}
;const u=[],d=e=>{const{projectName:o}=e;s.log(`${i} (lisner=${l.length}) - ${o} update`),l.forEach((o=>{s.log(`${i} send update event to - ${o.remoteAddress}:${o.remotePort}`),o.write(JSON.stringify(e))}))};o.fireProjectUpdateEvent=e=>{l.length?(u.length&&(u.forEach(d),u.length=0),d(e)):u.push(e)}},915:e=>{e.exports=require("../logger")},808:e=>{e.exports=require("net")}},o={};function t(n){var r=o[n];if(void 0!==r)return r.exports;var s=o[n]={exports:{}};return e[n](s,s.exports,t),s.exports}var n={};(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.subscribeProjectEvent=e.fireProjectUpdateEvent=e.launchMessageServer=void 0;const o=t(498),r=t(222);e.launchMessageServer=o.launchMessageServer,e.fireProjectUpdateEvent=o.fireProjectUpdateEvent,e.subscribeProjectEvent=r})(),
module.exports=n})();